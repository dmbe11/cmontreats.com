/*!
 DMXzone Lightbox
 Version: 1.0.2
 (c) 2018 DMXzone.com
 @build 2018-03-06 14:30:08
 */
!function(e){"use strict";function t(t,n){var o=e.createEvent("Event");o.initEvent(t,!0,!1),n.dispatchEvent(o)}function n(n){n.stopPropagation(),n.stopImmediatePropagation(),e[d.enabled]=e[r.enabled],e[d.element]=e[r.element],t(d.events.change,n.target)}function o(e){t(d.events.error,e.target)}function i(t){return function(n,o){function i(){n(),e.removeEventListener(r.events.change,i,!1)}function l(){o(new TypeError),e.removeEventListener(r.events.error,l,!1)}return t!==d.exit||e[r.element]?(e.addEventListener(r.events.change,i,!1),void e.addEventListener(r.events.error,l,!1)):void setTimeout(function(){o(new TypeError)},1)}}var r,l,s=!0,a={w3:{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",events:{change:"fullscreenchange",error:"fullscreenerror"}},webkit:{enabled:"webkitFullscreenEnabled",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullscreen",exit:"webkitExitFullscreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}},moz:{enabled:"mozFullScreenEnabled",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",events:{change:"mozfullscreenchange",error:"mozfullscreenerror"}},ms:{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",events:{change:"MSFullscreenChange",error:"MSFullscreenError"}}},d=a.w3;for(l in a)if(a[l].enabled in e){r=a[l];break}return!s||d.enabled in e||!r||(e.addEventListener(r.events.change,n,!1),e.addEventListener(r.events.error,o,!1),e[d.enabled]=e[r.enabled],e[d.element]=e[r.element],e[d.exit]=function(){var t=e[r.exit]();return!t&&window.Promise?new Promise(i(d.exit)):t},Element.prototype[d.request]=function(){var e=this[r.request].apply(this,arguments);return!e&&window.Promise?new Promise(i(d.request)):e}),r}(document),function(){"use strict";function e(){P=C("div",{class:w("Overlay"),role:"dialog"}),k=C("div",{class:w("Slider")}),F=C("button",{class:w("Button","Prev"),type:"button","aria-label":"Previous"}),T=C("button",{class:w("Button","Next"),type:"button","aria-label":"Next"}),B=C("button",{class:w("Button","Close"),type:"button","aria-label":"Close"}),P.appendChild(k),P.appendChild(F),P.appendChild(T),P.appendChild(B),document.body.appendChild(P),document.addEventListener("focus",p,!0),document.addEventListener("fullscreenchange",f),P.addEventListener("click",g),F.addEventListener("click",b),T.addEventListener("click",v),B.addEventListener("click",x),P.addEventListener("touchstart",y),P.addEventListener("touchend",E),P.addEventListener("touchmove",L)}function t(e){dmx.lightbox.options.noscrollbars&&(document.documentElement.style.setProperty("overflow","hidden"),document.body.style.setProperty("overflow","scroll")),o()||(document.addEventListener("keydown",h),O=e,c(e,function(){s(e),l(e)}),m(e),P.style.setProperty("display","block"),dmx.lightbox.options.fullscreen&&P.requestFullscreen&&P.requestFullscreen(),setTimeout(function(){P.classList.add(z+"Visible"),dmx.lightbox.component&&dmx.lightbox.component.dispatchEvent("show")},50),S=document.activeElement,u())}function n(){if(o()){for(var e=P.getElementsByTagName("video"),t=0;t<e.length;t++)e[t].paused||e[t].pause();dmx.lightbox.options.noscrollbars&&(document.documentElement.style.removeProperty("overflow"),document.body.style.removeProperty("overflow")),document.removeEventListener("keydown",h),P.classList.remove(z+"Visible"),setTimeout(function(){P.style.removeProperty("display"),document.fullscreenElement&&document.exitFullscreen(),dmx.lightbox.component&&dmx.lightbox.component.dispatchEvent("hide")},500),S.focus()}}function o(){return"block"===P.style.display}function i(){O>=1?(O--,m(),l(O)):"none"!==dmx.lightbox.options.animation&&(k.classList.add(z+"BounceLeft"),setTimeout(function(){k.classList.remove(z+"BounceLeft")},400))}function r(){O<=q.images.length-2?(O++,m(),s(O)):"none"!==dmx.lightbox.options.animation&&(k.classList.add(z+"BounceRight"),setTimeout(function(){k.classList.remove(z+"BounceRight")},400))}function l(e){c(e-1,function(){l(e-1)})}function s(e){c(e+1,function(){s(e+1)})}function a(e){for(q=e,d();k.firstChild;)k.removeChild(k.firstChild);e.nodes=e.nodes.filter(function(t){var n=document.body.contains(t);return n||(e.updated=!0),n}),e.updated&&(e.images=[],e.updated=!1);for(var t=[],n=[],o=0;o<e.nodes.length;o++)e.images[o]||e.images.push(C("div",{id:z+"Image"+o,class:z+"Image"})),t.push(z+"Figure"+o),n.push(z+"Caption"+o),k.appendChild(e.images[o]);P.setAttribute("aria-labelledby",t.join(" ")),P.setAttribute("aria-describedby",n.join(" "))}function d(){var e=dmx.extend(dmx.lightbox.options);k.style.transition="fade"===e.animation?"opacity .4s ease":"slide"===e.animation?"":"none","auto"===e.buttons&&("ontouchstart"in window||1===q.nodes.length)&&(e.buttons="hide"),F.style.display=T.style.display="hide"===e.buttons?"none":""}function u(){"hide"!==dmx.lightbox.options.buttons?F.focus():B.focus()}function c(e,t){var n=q.images[e],o=q.nodes[e];if(n&&o){var i=n.getElementsByTagName("figure")[0];if(i&&i.getAttribute("url")==o.href){if(t&&t(),dmx.lightbox.options.autoplay)for(var r=P.getElementsByTagName("video"),l=0;l<r.length;l++)r[l]==n.querySelector("video")?r[l].play():r[l].paused||r[l].pause()}else{i&&i.parentNode.removeChild(i);var s=C("figure",{id:z+"Figure"+e,url:o.href}),a=C("div",{class:w("Spinner",dmx.lightbox.options.spinner)});if(s.appendChild(a),o.title&&s.appendChild(C("figcaption",{id:z+"Caption"+e},o.title)),/\.(jpe?g|gif|png)$/i.test(o.href)){var d=C("img");d.onload=function(){s.removeChild(a),t&&t()},d.setAttribute("src",o.href),s.appendChild(d)}else if(/\.(mp4)$/i.test(o.href)){var u=C("video");u.controls=!0,u.loop=dmx.lightbox.options.loopvideo;var c=C("source",{src:o.href});u.addEventListener("canplay",function n(){u.removeEventListener("canplay",n),s.removeChild(a),t&&t(),dmx.lightbox.options.autoplay&&O===e&&u.play()}),u.appendChild(c),s.appendChild(u)}else s.appendChild(C("div",{},'<a href="'+o.href+'">Url not supported</a>')),s.removeChild(a),t&&t();n.appendChild(s)}}}function m(){var e="translate3d("+100*-O+"%,0,0)";"fade"===dmx.lightbox.options.animation?(k.style.setProperty("opacity",0),setTimeout(function(){k.style.setProperty("transform",e),k.style.setProperty("opacity",1)},400)):k.style.setProperty("transform",e)}function p(e){o()&&!P.contains(e.target)&&(e.stopPropagation(),u())}function f(e){document.fullscreenElement||n()}function h(e){switch(e.keyCode){case 37:i();break;case 39:r();break;case 27:n()}}function g(e){e.target.id.indexOf("dmxLightboxImage")!==-1&&n()}function b(e){e.stopPropagation(),i()}function v(e){e.stopPropagation(),r()}function x(e){e.stopPropagation(),n()}function y(e){A.count++,A.startX=e.changedTouches[0].pageX,A.startY=e.changedTouches[0].pageY}function E(e){A.count--,A.done=!1}function L(e){if(!(A.done||A.count>1)){e.preventDefault();var t=e.changedTouches[0].pageX,o=e.changedTouches[0].pageY;t-A.startX>40?(A.done=!0,i()):A.startX-t>40?(A.done=!0,r()):A.startY-o>100&&n()}}function C(e,t,n){var o=document.createElement(e);return t&&Object.keys(t).forEach(function(e){o.setAttribute(e,t[e])}),n&&(o.innerHTML=n),o}function w(){return z+[].join.call(arguments," "+z)}dmx.lightbox={count:0,gallery:{},options:{fullscreen:!1,noscrollbars:!1,autoplay:!1,loopvideo:!1,buttons:"auto",animation:"slide",spinner:"Spinner1"}};var P,k,F,T,B,S,q,O,z="dmxLightbox",A={count:0};dmx.lightbox.register=function(e){return dmx.lightbox.component?console.warn("Only 1 lightbox component should be used on the page!"):void(dmx.lightbox.component=e)},dmx.lightbox.getGallery=function(e){return dmx.lightbox.gallery[e]||(dmx.lightbox.gallery[e]={nodes:[],images:[]}),dmx.lightbox.gallery[e]},dmx.lightbox.addToGallery=function(e,t){var n=dmx.lightbox.getGallery(e);n.nodes.indexOf(t)===-1&&(n.nodes.push(t),n.updated=!0)},dmx.lightbox.setOptions=function(e){dmx.lightbox.options=dmx.extend(dmx.lightbox.options,e)},dmx.lightbox.run=function(n,o){var i=dmx.lightbox.gallery[n];return i?(P||e(),a(i),void t(i.nodes.indexOf(o))):alert("Gallery "+n+" does not exist.")}}(),dmx.Component("lightbox",{attributes:{fullscreen:{type:Boolean,default:!1},noscrollbars:{type:Boolean,default:!1},autoplay:{type:Boolean,default:!1},loopvideo:{type:Boolean,default:!1},buttons:{type:String,default:"auto"},animation:{type:String,default:"slide"},spinner:{type:String,default:"Spinner1"}},events:{show:Event,hide:Event},render:function(e){dmx.lightbox.register(this),dmx.BaseComponent.prototype.render.call(this,e)},update:function(e){dmx.lightbox.setOptions(this.props)}}),dmx.Attribute("lightbox","mounted",function(e,t){var n=t.argument||"dmxImage"+ ++dmx.lightbox.count;dmx.lightbox.addToGallery(n,e),e.addEventListener("click",function(t){t.preventDefault(),dmx.lightbox.run(n,e)})});
//# sourceMappingURL=../maps/dmxLightbox.js.map
